---
import { languages } from '../i18n/ui';
import { getLangFromUrl } from '../i18n/utils';

const lang = getLangFromUrl(Astro.url);
---
<select 
  class="text-sm bg-transparent border border-gray-300 rounded-md px-2 py-1"
  onchange="window.location.href=this.value"
>
  {Object.entries(languages).map(([code, name]) => (
    <option 
      value={`/${code === 'es' ? '' : code}`}
      selected={lang === code}
    >
      {name}
    </option>
  ))}
</select>

<script>
  // Asegurarse que el select muestre la opciÃ³n correcta al cargar
  document.addEventListener('astro:page-load', () => {
    const select = document.querySelector('select');
    const currentPath = window.location.pathname;
    select.value = currentPath.startsWith('/en') ? '/en' : '/';
  });
</script>
</div>